(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{363:function(t,a,s){"use strict";s.r(a);var n=s(9),r=Object(n.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"http跨域解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http跨域解决方案","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP跨域解决方案")]),t._v(" "),s("p",[t._v("浏览器同源策略导致不能加载执行其他网站的脚本，这是互联网安全的一部分。"),s("strong",[t._v("跨域之后ajax请求可以发出，但浏览器在接收前会对其来源进行检查")]),t._v("，如果是不跨域，直接加载数据；如果跨域，会出现著名的"),s("code",[t._v("No 'Access-Control-Allow-Origin' header is present on the requested resource")]),t._v("。以下总结一些常用的HTTP跨域解决方案。")]),t._v(" "),s("blockquote",[s("p",[t._v("常见的跨域都需要后端支持，跨域记得带上http头信息Access-Control-Allow-Origin")])]),t._v(" "),s("h2",{attrs:{id:"jsonp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jsonp","aria-hidden":"true"}},[t._v("#")]),t._v(" JSONP")]),t._v(" "),s("p",[t._v("利用浏览器script标签不跨域特点，使用get请求到目标api，再通过目标api返回callbackName(data)方式执行js代码。特点：")]),t._v(" "),s("ol",[s("li",[t._v("只能是get请求")]),t._v(" "),s("li",[t._v("需要后端配合，因为需要知道前端callbackName命名")]),t._v(" "),s("li",[t._v("支持老式浏览器")])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("var")]),t._v(" script "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("createElement")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v("'script'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nscript"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("type "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'text/javascript'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 传参并指定回调执行函数为onBack")]),t._v("\nscript"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v("'http://www.domain2.com:8080/login?user=admin&callback=onBack'")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("head"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("appendChild")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("script"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 回调执行函数")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("onBack")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{attrs:{class:"token function"}},[t._v("alert")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("stringify")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("// 服务端api返回")]),t._v("\n"),s("span",{attrs:{class:"token function"}},[t._v("onBack")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{attrs:{class:"token string"}},[t._v('"status"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token boolean"}},[t._v("true")]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"user"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"admin"')]),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cors","aria-hidden":"true"}},[t._v("#")]),t._v(" CORS")]),t._v(" "),s("p",[t._v("CORS 是一个 W3C 标准，全称是“跨域资源共享”（Cross-origin resource sharing）。它允许浏览器向跨域的服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。特点：")]),t._v(" "),s("ol",[s("li",[t._v("W3C标准")]),t._v(" "),s("li",[t._v("需要浏览器和服务器同时支持")])]),t._v(" "),s("h3",{attrs:{id:"cors简单请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cors简单请求","aria-hidden":"true"}},[t._v("#")]),t._v(" CORS简单请求")]),t._v(" "),s("ul",[s("li",[t._v("请求方法：三种方法之一\n"),s("ul",[s("li",[t._v("HEAD")]),t._v(" "),s("li",[t._v("GET")]),t._v(" "),s("li",[t._v("POST")])])]),t._v(" "),s("li",[t._v("HTTP头信息：不超出以下几种字段\n"),s("ul",[s("li",[t._v("Accept")]),t._v(" "),s("li",[t._v("Accept-Language")]),t._v(" "),s("li",[t._v("Content-Language")]),t._v(" "),s("li",[t._v("Last-Event-ID")]),t._v(" "),s("li",[t._v("Content-Type：只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain")])])])]),t._v(" "),s("p",[t._v("在头信息之中，增加一个Origin字段。说明本次请求来自哪个域（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。")]),t._v(" "),s("h3",{attrs:{id:"cors非简单请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cors非简单请求","aria-hidden":"true"}},[t._v("#")]),t._v(" CORS非简单请求")]),t._v(" "),s("ul",[s("li",[t._v("请求方法\n"),s("ul",[s("li",[t._v("PUT")]),t._v(" "),s("li",[t._v("DELETE")])])]),t._v(" "),s("li",[t._v("HTTP头信息：\n"),s("ul",[s("li",[t._v("Content-Type：application/json")])])])]),t._v(" "),s("p",[t._v("非简单请求，自动发出一个“预检”请求，要求服务器确认可以这样请求。服务器通过预检后，后续浏览器会发送一个简单请求。")]),t._v(" "),s("h2",{attrs:{id:"其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他","aria-hidden":"true"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),s("ul",[s("li",[t._v("服务端\n"),s("ul",[s("li",[t._v("nginx代理跨域")]),t._v(" "),s("li",[t._v("nodejs代理跨域")]),t._v(" "),s("li",[t._v("websocket")])])]),t._v(" "),s("li",[t._v("浏览器\n"),s("ul",[s("li",[t._v("html5 postMessage")]),t._v(" "),s("li",[t._v("iframe")])])])]),t._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),s("ul",[s("li",[t._v("MDN "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cross-Origin Resource Sharing (CORS)"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://javascript.ruanyifeng.com/bom/cors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS通信"),s("OutboundLink")],1)])])])},[],!1,null,null,null);r.options.__file="http-cross-domain.md";a.default=r.exports}}]);